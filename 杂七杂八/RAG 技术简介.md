### **一、RAG 技术简介**

RAG（Retrieval-Augmented Generation）是一种结合 **检索（Retrieval）** 和 **生成（Generation）** 的技术，通过从外部知识库中检索相关信息，辅助生成更准确、更符合上下文的回答。适用于以下场景：

- 企业知识库问答
- 客服自动化
- 长文本内容总结
- 多文档交叉分析

------

### **二、Coze 平台 RAG 使用步骤**

#### **1. 准备知识库**

- **支持格式**：PDF、TXT、Word、Markdown、网页链接等。
- **文档要求**：
  - 内容清晰，避免扫描图片或复杂表格。
  - 单个文件建议不超过 50MB。
- **示例**：上传企业产品手册、客服常见问题文档、学术论文等。

#### **2. 创建知识库**

1. 进入 Coze 平台，点击 **「知识库」** → **「新建知识库」**。
2. 填写知识库名称和描述（例如：“产品手册知识库”）。
3. **上传文件** 或输入网页链接，支持批量上传。
4. **配置分块规则**（关键步骤）：
   - **分块大小**：根据文本类型调整（例如技术文档建议 512 tokens，对话文本建议 256 tokens）。
   - **重叠窗口**：设置 10%-20% 的重叠内容，避免信息割裂。
   - **元数据**：添加标签（如“技术文档-2024版”）方便后续检索。

#### **3. 创建 RAG 机器人**

1. 进入 **「BOT 工作室」** → **「新建机器人」**。
2. 输入机器人名称（例如：“产品客服助手”），选择应用场景。
3. **添加技能** → 选择 **「知识库检索」** → 关联已创建的知识库。
4. **配置检索参数**：
   - **Top-K**：设置每次检索返回的文档片段数量（建议 3-5 条）。
   - **相似度阈值**：过滤低相关性内容（例如设为 0.7）。
   - **混合检索模式**：同时支持关键词匹配和语义检索。

#### **4. 编写 Prompt 模板**

在机器人 **「提示词」** 模块中，设计引导生成的模板：

python

复制

```
# 示例 Prompt
你是一个专业客服助手，请根据以下知识库内容回答问题：
{{检索到的知识}}

用户问题：{{用户输入}}
回答要求：
1. 用中文简洁回答，不超过 200 字。
2. 如果知识库无相关信息，回答“暂未找到相关文档，请联系人工客服”。
```

#### **5. 测试与优化**

1. 使用 **「对话测试」** 功能，输入典型问题（如产品功能、故障排查）。
2. 分析结果：
   - 若回答不准确 → 检查知识库分块是否合理。
   - 若遗漏信息 → 调整 Top-K 或相似度阈值。
   - 若生成内容冗余 → 优化 Prompt 中的回答约束。

------

### **三、高级配置技巧**

#### **1. 多知识库混合调用**

- 场景：需要同时访问多个独立知识库（如产品库+政策库）。

- 操作：在机器人配置中关联多个知识库，并在 Prompt 中指定优先级：

  python

  复制

  ```
  请优先从「产品手册」中检索信息，若无结果再查询「售后政策库」。
  ```

#### **2. 动态参数过滤**

- 使用元数据过滤：

  python

  复制

  ```
  如果用户问题包含“最新版”，则只检索标签为“2024版”的文档。
  ```

#### **3. 结合外部 API**

- 场景：需要实时数据（如库存、价格）与知识库静态信息结合。
- 操作：
  1. 在 **「工作流」** 中添加 API 调用节点。
  2. 将 API 返回数据与 RAG 结果合并后生成回答。

------

### **四、常见问题与解决**

| 问题现象         | 可能原因        | 解决方案                               |
| :--------------- | :-------------- | :------------------------------------- |
| 回答“未找到信息” | 知识库分块过大  | 减小分块大小（如改为 256 tokens）      |
| 回答包含无关内容 | 相似度阈值过低  | 将阈值从 0.6 提升至 0.75               |
| 生成内容格式混乱 | Prompt 约束不足 | 在 Prompt 中添加格式要求（如分点回答） |

------

### **五、最佳实践建议**

1. **知识库维护**：定期更新文档，删除过期内容。
2. **AB 测试**：对同一问题设置不同分块策略，对比回答质量。
3. **用户反馈循环**：添加“是否满意回答”的交互按钮，收集数据优化模型。